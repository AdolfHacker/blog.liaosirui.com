## 虚拟化的概念

虚拟化，是指通过虚拟化技术将一台计算机虚拟为多台逻辑计算机。

在一台计算机上同时运行多个逻辑计算机，每个逻辑计算机可运行不同的操作系统，并且应用程序都可以在相互独立的空间内运行而互不影响，从而显著提高计算机的工作效率虚拟化使用软件的方法重新定义划分 IT 资源，可以实现 IT 资源的动态分配、灵活调度、跨域共享，提高 IT 资源利用率，使 IT 资源能够真正成为社会基础设施，服务于各行各业中灵活多变的应用需求。 

<img src=".assets/image-20221214103110912.png" alt="image-20221214103110912"  />

## 为什么要用虚拟化

提高计算机资源的利用率和程序运行环境的安全隔离，还可以有效限制程序的资源占用 

1. 降低运营成本 - 服务器虚拟化降低了 IT 基础设施的运营成本，令系统管理员摆脱了繁重的物理服务器、OS、中间件及兼容性的管理工作，减少人工干预频率，使管理更加强大、便捷
2. 提高应用兼容性 - 服务器虚拟化提供的封装性和隔离性使大量应用独立运行于各种环境中，管理人员不需频繁根据底层环境调整应用，只需构建一个应用版本并将其发布到虚拟化后的不同类型平台上即可
3. 加速应用部署 - 采用服务器虚拟化技术只需输入激活配置参数、拷贝虚拟机、启动虚拟机、激活虚拟机即可完成部署，大大缩短了部署时间，免除人工干预，降低了部署成本
4. 提高服务可用性 - 用户可以方便地备份虚拟机，在进行虚拟机动态迁移后，可以方便的恢复备份，或者在其他物理机上运行备份，大大提高了服务的可用性
5. 提升资源利用率 - 通过服务器虚拟化的整合，提高了 CPU、内存、存储、网络等设备的利用率，同时保证原有服务的可用性，使其安全性及性能不受影响
6. 动态调度资源 - 在服务器虚拟化技术中，数据中心从传统的单一服务器变成了统一的资源池，用户可以即时地调整虚拟机资源，同时数据中心管理程序和数据中心管理员可以灵活根据虚拟机内部资源使用情况灵活分配调整给虚拟机的资源
7. 降低能源消耗 - 通过减少运行的物理服务器数量，减少 CPU 以外各单元的耗电量，达到节能减排的目的

## 虚拟化在企业中的应用场景

场景 1：多版本操作系统共存，小公司经常会出现的一种比较尴尬的问题，只有一台服务器，非要同时运行 windows 和 Linux，只有虚拟化才能完美解决

场景 2：机房迁移，没有虚拟化之前，迁移非常痛苦，物理机搬迁中途损伤，新机房很难复原旧环境，物理机老化可能再也开不了机，这些都是问题，有了虚拟化之后，搬迁变得简单，只需拷贝虚拟机的文件即可 

场景 3：相同业务部署，在没有虚拟化之前，部署业务，每次都是从安装系统开始，一步一步安装软件，效率非常低！有了虚拟化，只需克隆模板机即可

场景 4：软件发布体验，有的软件安装特别繁琐，导致很多普通用户都无法安装成功，为了让这部分用户能体验到软件的功能，可以制作一个虚拟机模板，让用户直接使用体验，例如 zabbix 就有现成的虚拟机模板

## QEMU 简介

QEMU (需要一个专门的内核) 

QEMU 是一套由法布里斯・贝拉 (Fabrice Bellard) 所编写的模拟处理器的自由软件。它与 Bochs (Bochs 是一个 x86 硬件平台的开源模拟器。它可以模拟各种硬件的配置。)，PearPC (实现 PC 机上安装 Mac OS) 近似，但其具有某些后两者所不具备的特性，如高速度及跨平台的特性。经由 KVM (早期为 kqemu 加速器，现在 kqemu 已被 KVM 取代) 这个开源的加速器，QEMU 能模拟至接近真实电脑的速度。

QEMU 有两种主要运作模式：

- User mode 模拟模式，亦即是用户模式。QEMU 能引导那些为不同中央处理器编译的 Linux 程序。而 Wine (运行 Windows 应用的兼容层。) 及 Dosemu (DOS 模拟器) 是其主要目标。
- System mode 模拟模式，亦即是系统模式。QEMU 能模拟整个电脑系统，包括中央处理器及其他周边设备。它使得为系统源代码进行测试及除错工作变得容易。其亦能用来在一部主机上模拟数部不同虚拟电脑。性能特别好，但是需要使用专门修改之后的内核。　　
