官方文档地址：<http://www.beegfs.io/wiki/BuildingKernelModulesOpenTkLibrary>

配置文件

```bash
/etc/beegfs/beegfs-client-autobuild.conf
```

查看配置

```bash
> cat /etc/beegfs/beegfs-client-autobuild.conf  | grep -v '^#' | grep -v '^$'

buildArgs=-j8
buildEnabled=true
```

重新构建

```bash
/etc/init.d/beegfs-client rebuild
```

重启客户端

```bash
/etc/init.d/beegfs-client restart
```

查看 ib 模块是否安装

```bash
> modinfo ib_core
 
filename:       /lib/modules/5.14.0-70.30.1.el9_0.x86_64/extra/mlnx-ofa_kernel/drivers/infiniband/core/ib_core.ko
alias:          rdma-netlink-subsys-4
license:        Dual BSD/GPL
description:    core kernel InfiniBand API
author:         Roland Dreier
alias:          net-pf-16-proto-20
alias:          rdma-netlink-subsys-5
import_ns:      DMA_BUF
rhelversion:    9.0
srcversion:     7D627890E2EE4311DC1E835
depends:        mlx_compat
retpoline:      Y
name:           ib_core
vermagic:       5.14.0-70.30.1.el9_0.x86_64 SMP preempt mod_unload modversions
parm:           send_queue_size:Size of send queue in number of work requests (int)
parm:           recv_queue_size:Size of receive queue in number of work requests (int)
parm:           mad_smp_window:Maximun number of outgoing SMP requests (int)
parm:           netns_mode:Share device among net namespaces; default=1 (shared) (bool)
parm:           force_mr:Force usage of MRs for RDMA READ/WRITE operations (bool)
```

修改构建参数

```bash
buildArgs=-j8 BEEGFS_OPENTK_IBVERBS=1 OFED_INCLUDE_PATH=/usr/src/ofa_kernel/default/include
```

